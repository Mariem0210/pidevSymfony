{% extends 'home.html.twig' %}

{% block title %}Détails du Giveaway - {{ giveaway.titreg }}{% endblock %}

{% block content %}
<!-- breadcrumb start-->
<section class="breadcrumb breadcrumb_bg">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb_iner text-center">
                    <div class="breadcrumb_iner_item">
                        <h2>{{ giveaway.titreg }}</h2>
                        <p>Détails du giveaway</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- breadcrumb end-->

<!-- giveaway details section -->
<section class="about_us section_padding">
    <div class="container">
        <div class="row align-items-center justify-content-between">
            <div class="col-md-6 col-lg-6">
                <div class="about_text">
                    <h3>Description</h3>
                    <p>{{ giveaway.descg }}</p>

                    <div class="about_single_item">
                        <h4>Informations</h4>
                        <ul class="list-unstyled">
                            <li><i class="ti-calendar"></i> <span>Date de début:</span> {{ giveaway.datedg|date('d/m/Y') }}</li>
                            <li><i class="ti-calendar"></i> <span>Date de fin:</span> {{ giveaway.datefg|date('d/m/Y') }}</li>
                        </ul>
                    </div>
                    
                    <a href="{{ path('app_giveaway_index_frontend') }}" class="btn_1">Retour à la liste</a>
                    <a href="#" class="btn_2 ml-3">Participer</a>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- giveaway details section end -->

<!-- countdown section start -->
<section class="testimonial_part">
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-xl-5">
                <div class="section_tittle text-center">
                    <h2>Temps restant</h2>
                    <p>Ne manquez pas votre chance de participer à ce giveaway !</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="textimonial_iner owl-carousel">
                    <div class="testimonial_slider">
                        <div class="row">
                            <div class="col-lg-12 col-xl-12 text-center">
                                <div id="countdown" class="d-flex justify-content-center">
                                    <div class="countdown-item mx-3">
                                        <h3 id="days">00</h3>
                                        <p>Jours</p>
                                    </div>
                                    <div class="countdown-item mx-3">
                                        <h3 id="hours">00</h3>
                                        <p>Heures</p>
                                    </div>
                                    <div class="countdown-item mx-3">
                                        <h3 id="minutes">00</h3>
                                        <p>Minutes</p>
                                    </div>
                                    <div class="countdown-item mx-3">
                                        <h3 id="seconds">00</h3>
                                        <p>Secondes</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- countdown section end -->
{% endblock %}

{% block js %}
<script>
    // Countdown Timer for Giveaway
    document.addEventListener('DOMContentLoaded', function() {
        // Get the giveaway end date from Twig and ensure it's in ISO format
        const endDate = new Date("{{ giveaway.datefg|date('c') }}").getTime();
        
        // Debugging: Check the end date value
        console.log("End Date:", endDate);  // Add this line for debugging purposes
        
        // Update the countdown every second
        const countdownTimer = setInterval(function() {
            // Get today's date and time
            const now = new Date().getTime();
            
            // Find the distance between now and the end date
            const distance = endDate - now;
            
            // Time calculations for days, hours, minutes, and seconds
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            // Display the result
            document.getElementById("days").innerHTML = days.toString().padStart(2, '0');
            document.getElementById("hours").innerHTML = hours.toString().padStart(2, '0');
            document.getElementById("minutes").innerHTML = minutes.toString().padStart(2, '0');
            document.getElementById("seconds").innerHTML = seconds.toString().padStart(2, '0');
            
            // If the countdown is finished, show the expired message
            if (distance < 0) {
                clearInterval(countdownTimer);
                document.getElementById("countdown").innerHTML = "<h3>Ce giveaway est terminé</h3>";
            }
        }, 1000);
    });
</script>
{% endblock %}
